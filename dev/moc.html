<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Method of Characteristics · NeutronTransport.jl</title><link rel="canonical" href="https://rvignolo.github.io/NeutronTransport.jl/moc.html"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">NeutronTransport.jl</span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="index.html">Introduction</a></li><li class="is-active"><a class="tocitem" href="moc.html">Method of Characteristics</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Nomenclature"><span>Nomenclature</span></a></li><li><a class="tocitem" href="#Formulation"><span>Formulation</span></a></li><li><a class="tocitem" href="#Discretization-scheme"><span>Discretization scheme</span></a></li></ul></li><li><a class="tocitem" href="references.html">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="moc.html">Method of Characteristics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="moc.html">Method of Characteristics</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/rvignolo/NeutronTransport.jl/blob/master/docs/src/moc.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Method-of-Characteristics"><a class="docs-heading-anchor" href="#Method-of-Characteristics">Method of Characteristics</a><a id="Method-of-Characteristics-1"></a><a class="docs-heading-anchor-permalink" href="#Method-of-Characteristics" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>Lattice computations, where a representative lattice is solved by means of an adequate transport formulation, are the first step of deterministic reactor calculations and analysis. The Collision Probability Method (CP) and the Method of Characteristics (MOC) are among these formulations. Both of them compute the scalar flux over well-discretized energy and region meshes that is later used to obtain homogenized cross sections for core-level calculations.</p><p>At first, representative lattices used to be unique 2D square <em>pin cells</em> geometries. Nowadays, with the increment of computing power, lattice domains became arrangements of <em>pin cells</em> that may represent one or many fuel elements. Collision Probability methods can handle these complex geometries but they become impractical as the numer of regions increases. On the other hand, over the last years, the Method of Characteristics gain particular interest because it can handle fuel arrangements or even complete cores, overcoming CP limitations.</p><p>The Method of Characteristics obtains the neutron flux distribution by solving the characteristic form of the transport equation over tracks that emulate neutron trajectories across the problem domain.</p><p>It was the selected formulation since it overcomes the main limitation for the Collision Probability (CP) method: it does not produce full square matrices of order equal to the number of regions in the domain times the energy groups, so it is possible to solve problems with many more regions.</p><p>In this context, an efficient ray tracing algorithm for unstructured meshes (see <a href="https://github.com/rvignolo/RayTracing.jl">RayTracing.jl</a>) was developed in first place. Now, this package allows computing the scalar flux per region and energy group by collecting all mean angular fluxes over track segments and region sources.</p><h2 id="Nomenclature"><a class="docs-heading-anchor" href="#Nomenclature">Nomenclature</a><a id="Nomenclature-1"></a><a class="docs-heading-anchor-permalink" href="#Nomenclature" title="Permalink"></a></h2><p>The following is the nomenclature used in the documentation:</p><table><tr><th style="text-align: right">.</th><th style="text-align: right">.</th><th style="text-align: right">.</th><th style="text-align: right">.</th></tr><tr><td style="text-align: right"><strong>Symbols:</strong></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right"><span>$\vec{x}$</span></td><td style="text-align: right">Position vector.</td><td style="text-align: right"><span>$\ell$</span></td><td style="text-align: right">Track segment length.</td></tr><tr><td style="text-align: right"><span>$\boldsymbol{\hat{\Omega}}$</span></td><td style="text-align: right">Direction of motion versor.</td><td style="text-align: right"><span>$k$</span></td><td style="text-align: right">Multiplication factor.</td></tr><tr><td style="text-align: right"><span>$\varphi$</span></td><td style="text-align: right">Azimuthal angle.</td><td style="text-align: right"><span>$Q$</span></td><td style="text-align: right">Scalar source.</td></tr><tr><td style="text-align: right"><span>$\theta$</span></td><td style="text-align: right">Polar angle.</td><td style="text-align: right"><span>$q$</span></td><td style="text-align: right">Angular source.</td></tr><tr><td style="text-align: right"><span>$\psi$</span></td><td style="text-align: right">Angular flux.</td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right"><span>$\phi$</span></td><td style="text-align: right">Scalar flux.</td><td style="text-align: right"><strong>Subindexes:</strong></td><td style="text-align: right"></td></tr><tr><td style="text-align: right"><span>$\Sigma^t$</span></td><td style="text-align: right">Total cross-section.</td><td style="text-align: right"><span>$g$</span></td><td style="text-align: right">Energy group.</td></tr><tr><td style="text-align: right"><span>$\Sigma^a$</span></td><td style="text-align: right">Absorption cross-section.</td><td style="text-align: right"><span>$i$</span></td><td style="text-align: right">Flat source region.</td></tr><tr><td style="text-align: right"><span>$\Sigma^f$</span></td><td style="text-align: right">Fission cross-section.</td><td style="text-align: right"><span>$a$</span></td><td style="text-align: right">Azimuthal angle.</td></tr><tr><td style="text-align: right"><span>$\Sigma^s$</span></td><td style="text-align: right">Scattering cross-section.</td><td style="text-align: right"><span>$p$</span></td><td style="text-align: right">Polar angle.</td></tr><tr><td style="text-align: right"><span>$\nu$</span></td><td style="text-align: right">Neutrons per fission.</td><td style="text-align: right"><span>$m$</span></td><td style="text-align: right">Solid angle.</td></tr><tr><td style="text-align: right"><span>$\chi$</span></td><td style="text-align: right">Fission spectrum.</td><td style="text-align: right"><span>$k$</span></td><td style="text-align: right">Track segment.</td></tr></table><h2 id="Formulation"><a class="docs-heading-anchor" href="#Formulation">Formulation</a><a id="Formulation-1"></a><a class="docs-heading-anchor-permalink" href="#Formulation" title="Permalink"></a></h2><p>The steady-state integro-differential neutron transport equation is extensively discussed in the bibliography. In its multigroup form, the continuous dependence on energy is replaced by a discrete scheme, yielding:</p><p class="math-container">\[\boldsymbol{\hat{\Omega}} \cdot \nabla \psi_g(\vec{x}, \boldsymbol{\hat{\Omega}})
 + \Sigma^t_g(\vec{x}) \cdot \psi_g(\vec{x}, \boldsymbol{\hat{\Omega}}) = q_g(\vec{x}, \boldsymbol{\hat{\Omega}}).\]</p><p>This equation defines a linear first-order partial differential equation (PDE) if we assume that the flux is known inside the source term <span>$q_g(\vec{x}, \boldsymbol{\hat{\Omega}})$</span>. Then, it can be casted to a family of linear first-order ordinary differential equations (ODEs) by means of the method of characteristics. In this context, we would want to transform the linear first-order PDE into an ODE along the appropriate curve <span>$\vec{x}(s)$</span>; i.e. something of the form:</p><p class="math-container">\[\frac{d}{ds} \psi(\vec{x}(s), \boldsymbol{\hat{\Omega}}) = F(\vec{x}(s), \psi(\vec{x}(s), \boldsymbol{\hat{\Omega}})).\]</p><p>Using the chain rule, we get:</p><p class="math-container">\[\frac{d}{ds} \psi(\vec{x}(s), \boldsymbol{\hat{\Omega}}) = \frac{\partial \psi}{\partial x} \frac{dx}{ds} +
                     \frac{\partial \psi}{\partial y} \frac{dy}{ds} +
                     \frac{\partial \psi}{\partial z} \frac{dz}{ds} =
                     \frac{d \vec{x}}{ds} \cdot \nabla \psi(\vec{x}(s), \boldsymbol{\hat{\Omega}}),\]</p><p>which, inserted in the previous equation, yields:</p><p class="math-container">\[\frac{d \vec{x}}{ds} \cdot \nabla \psi(\vec{x}(s), \boldsymbol{\hat{\Omega}}) = F(\vec{x}(s), \psi(\vec{x}(s), \boldsymbol{\hat{\Omega}})).\]</p><p>By setting <span>$d \vec{x} / ds = \boldsymbol{\hat{\Omega}}$</span>, we get:</p><p class="math-container">\[\boldsymbol{\hat{\Omega}} \cdot \nabla \psi(\vec{x}(s), \boldsymbol{\hat{\Omega}}) = F(\vec{x}(s), \psi(\vec{x}(s), \boldsymbol{\hat{\Omega}})),\]</p><p>which is equivalent to the original PDE if:</p><p class="math-container">\[F(\vec{x}(s), \psi(\vec{x}(s), \boldsymbol{\hat{\Omega}})) = q(\vec{x}(s), \boldsymbol{\hat{\Omega}}) - \Sigma^t(\vec{x}(s)) \cdot \psi(\vec{x}(s), \boldsymbol{\hat{\Omega}}).\]</p><p>Now, solving equation <span>$\vec{x}(s)$</span> yields to the parametric equations of the characteristic curves:</p><p class="math-container">\[ \vec{x}(s) = \vec{x}_0 + s \boldsymbol{\hat{\Omega}},\]</p><p>for arbitrary <span>$\vec{x}_0$</span>. It can be conclude that, along the characteristic curves <span>$\vec{x}(s)$</span>, the original PDE becomes the following ODE:</p><p class="math-container">\[\frac{d}{ds} \psi_g(s, \boldsymbol{\hat{\Omega}}) + \Sigma^t_g(s) \cdot \psi_g(s, \boldsymbol{\hat{\Omega}}) = q_g(s, \boldsymbol{\hat{\Omega}}),\]</p><p>where the abuse of notation <span>$\vec{x}_0 + s \boldsymbol{\hat{\Omega}} \rightarrow s$</span> has been used.</p><p>At the beginning of the section, we stated that the source term is known. However, in reality, the source term in the transport equation is unknown, since it is given by:</p><p class="math-container">\[q_g(s, \boldsymbol{\hat{\Omega}}) =
 \sum_{g^\prime=1}^G \int_{4\pi} \Sigma^s_{g^\prime \rightarrow g}(s, \boldsymbol{\hat{\Omega}^\prime} \rightarrow \boldsymbol{\hat{\Omega}}) \cdot \psi_{g^\prime}(s, \boldsymbol{\hat{\Omega}^\prime}) \, d\boldsymbol{\hat{\Omega}^\prime} + \frac{\chi_g(s)}{4\pi k_{\text{eff}}} \sum_{g^\prime=1}^G \int_{4\pi} \nu\Sigma^f_{g^\prime}(s) \cdot \psi_{g^\prime}(s, \boldsymbol{\hat{\Omega}^\prime}) \, d\boldsymbol{\hat{\Omega}^\prime}.\]</p><p>for eigenvalue problems (without external sources). Additionally, when considering isotropic scattering, the previous expression reduces to:</p><p class="math-container">\[ q_g(s, \boldsymbol{\hat{\Omega}}) =
 \frac{1}{4\pi} \sum_{g^\prime=1}^G \Sigma^s_{g^\prime \rightarrow g}(s) \cdot \phi_{g^\prime}(s) + \frac{\chi_g(s)}{4\pi k_{\text{eff}}} \sum_{g^\prime=1}^G \nu\Sigma^f_{g^\prime}(s) \cdot \phi_{g^\prime}(s)  = q_g(s).\]</p><p>Consequently, even though the ODE may be integrated to find a solution, an iterative scheme over the source term must be used to converge to the true solution. Commonly, each of these iterations is known as a <em>transport sweep</em>.</p><h2 id="Discretization-scheme"><a class="docs-heading-anchor" href="#Discretization-scheme">Discretization scheme</a><a id="Discretization-scheme-1"></a><a class="docs-heading-anchor-permalink" href="#Discretization-scheme" title="Permalink"></a></h2><p>In order to find a numerical solution to the transport equation we must transform the continuous operators and dependencies into discrete versions. Up to this point we have only applied a discretization scheme to the energy dependence. We now apply a discretization scheme to the other continuous dependencies: solid angle <span>$\boldsymbol{\hat{\Omega}}$</span> and spatial variables.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="index.html">« Introduction</a><a class="docs-footer-nextpage" href="references.html">References »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 12 January 2021 22:38">Tuesday 12 January 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
